{
    "version": 20251216,
    "effective_date": "2024-12-16",
    "changelog": "Tax Engine 2025 - Đầy đủ 29 quy tắc thuế theo TT219, TT96, TT111, TT78",
    "breaking_changes": [],
    "rules": [
        {
            "code": "VAT_STANDARD",
            "rule_type": "VAT_RATE",
            "category": "GENERAL",
            "action": "SET_RATE",
            "value": 10,
            "description": "Thuế suất VAT tiêu chuẩn",
            "reference": "Luật thuế GTGT",
            "effective_from": "2024-01-01"
        },
        {
            "code": "VAT_AGRI_5",
            "rule_type": "VAT_RATE",
            "category": "AGRI_PROD",
            "action": "SET_RATE",
            "value": 5,
            "description": "Thuế suất VAT nông sản thương mại",
            "reference": "TT219/2013/TT-BTC",
            "effective_from": "2024-01-01"
        },
        {
            "code": "VAT_AGRI_0",
            "rule_type": "VAT_RATE",
            "category": "AGRI_RAW",
            "action": "SET_RATE",
            "value": 0,
            "description": "Thuế suất VAT nông sản sơ chế",
            "reference": "TT219/2013/TT-BTC",
            "effective_from": "2024-01-01"
        },
        {
            "code": "VAT_NON_CASH",
            "rule_type": "VAT_DEDUCTIBLE",
            "category": "PAYMENT_METHOD",
            "action": "DENY",
            "value": 20000000,
            "condition": {
                "AND": [
                    {
                        "amount_gte": 20000000
                    },
                    {
                        "payment_method": "CASH"
                    }
                ]
            },
            "description": "HĐ >= 20tr VND thanh toán tiền mặt không được khấu trừ VAT",
            "reference": "TT219/2013/TT-BTC Điều 15",
            "effective_from": "2014-01-01"
        },
        {
            "code": "VAT_CAR_LUXURY",
            "rule_type": "VAT_DEDUCTIBLE",
            "category": "VEHICLE",
            "action": "PARTIAL",
            "value": 1600000000,
            "limit_value": 1600000000,
            "condition": {
                "AND": [
                    {
                        "asset_type": "CAR_UNDER_9_SEATS"
                    },
                    {
                        "original_price_gt": 1600000000
                    },
                    {
                        "biz_type_not": "TRANSPORT"
                    }
                ]
            },
            "description": "Xe < 9 chỗ > 1.6 tỷ: chỉ phần VAT tương ứng 1.6 tỷ được khấu trừ",
            "reference": "TT96/2015/TT-BTC",
            "effective_from": "2015-01-01"
        },
        {
            "code": "VAT_SUPPLIER_STATUS",
            "rule_type": "VAT_DEDUCTIBLE",
            "category": "SUPPLIER",
            "action": "DENY",
            "value": 0,
            "condition": {
                "supplier_status_in": [
                    "SUSPENDED",
                    "CLOSED",
                    "BANKRUPT"
                ]
            },
            "description": "HĐ từ NCC bị đình chỉ/đóng MST/phá sản không hợp lệ",
            "reference": "TT219/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "VAT_INFO_CHECK",
            "rule_type": "VAT_DEDUCTIBLE",
            "category": "INVOICE_INFO",
            "action": "DENY",
            "value": 0,
            "condition": {
                "OR": [
                    {
                        "buyer_tax_code": null
                    },
                    {
                        "buyer_name_mismatch": true
                    }
                ]
            },
            "description": "HĐ thiếu MST hoặc sai tên người mua không được khấu trừ",
            "reference": "TT219/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "VAT_NON_BIZ",
            "rule_type": "VAT_DEDUCTIBLE",
            "category": "USAGE_PURPOSE",
            "action": "DENY",
            "value": 0,
            "condition": {
                "OR": [
                    {
                        "usage_purpose": "PERSONAL"
                    },
                    {
                        "fund_source": "WELFARE_FUND"
                    }
                ]
            },
            "description": "Chi phí cá nhân hoặc quỹ phúc lợi không được khấu trừ VAT",
            "reference": "TT219/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "CIT_TAX_RATE",
            "rule_type": "CIT_ADD_BACK",
            "category": "TAX_RATE",
            "action": "SET_RATE",
            "value": 20,
            "description": "Thuế suất thuế TNDN 20%",
            "reference": "Điều 10 Luật Thuế TNDN",
            "effective_from": "2014-01-01"
        },
        {
            "code": "CIT_PENALTY",
            "rule_type": "CIT_ADD_BACK",
            "category": "ADMIN_PENALTY",
            "action": "ADD_BACK",
            "value": 100,
            "condition": {
                "expense_type": "ADMIN_PENALTY"
            },
            "description": "Tiền phạt hành chính (ATGT, thuế...) không được trừ - cộng ngược 100%",
            "reference": "TT78/2014/TT-BTC Điều 6",
            "effective_from": "2014-08-01"
        },
        {
            "code": "CIT_DEPRECIATION_CAP",
            "rule_type": "CIT_ADD_BACK",
            "category": "DEPRECIATION",
            "action": "ADD_BACK",
            "value": 1600000000,
            "limit_value": 1600000000,
            "condition": {
                "AND": [
                    {
                        "asset_type": "CAR_UNDER_9_SEATS"
                    },
                    {
                        "purchase_price_gt": 1600000000
                    },
                    {
                        "biz_type_not": "TRANSPORT"
                    }
                ]
            },
            "description": "Khấu hao xe < 9 chỗ > 1.6 tỷ: phần vượt không được trừ",
            "reference": "TT96/2015/TT-BTC",
            "effective_from": "2015-01-01"
        },
        {
            "code": "CIT_WELFARE_CAP",
            "rule_type": "CIT_ADD_BACK",
            "category": "WELFARE",
            "action": "ADD_BACK",
            "value": 1,
            "condition": {
                "expense_type": "WELFARE"
            },
            "description": "Chi phúc lợi vượt 1 tháng lương bình quân: phần vượt không được trừ",
            "reference": "TT96/2015/TT-BTC Điều 6",
            "effective_from": "2015-01-01"
        },
        {
            "code": "CIT_NO_INVOICE",
            "rule_type": "CIT_ADD_BACK",
            "category": "NO_INVOICE",
            "action": "ADD_BACK",
            "value": 100,
            "condition": {
                "OR": [
                    {
                        "has_valid_invoice": false
                    },
                    {
                        "AND": [
                            {
                                "amount_gte": 20000000
                            },
                            {
                                "payment_method": "CASH"
                            }
                        ]
                    }
                ]
            },
            "description": "Chi phí không HĐ hoặc >= 20tr tiền mặt: cộng ngược 100%",
            "reference": "TT96/2015/TT-BTC Điều 6",
            "effective_from": "2015-01-01"
        },
        {
            "code": "CIT_CASUAL_LABOR",
            "rule_type": "CIT_ADD_BACK",
            "category": "CASUAL_LABOR",
            "action": "ADD_BACK",
            "value": 100,
            "condition": {
                "AND": [
                    {
                        "labor_type": "CASUAL"
                    },
                    {
                        "amount_gte": 2000000
                    },
                    {
                        "pit_withheld": 0
                    },
                    {
                        "has_commitment_08": false
                    }
                ]
            },
            "description": "Lương LĐ thời vụ >= 2tr không khấu trừ 10% (không có cam kết 08): cộng ngược 100%",
            "reference": "TT96/2015/TT-BTC Điều 6",
            "effective_from": "2015-01-01"
        },
        {
            "code": "CIT_MATERIALS_EXCESS",
            "rule_type": "CIT_ADD_BACK",
            "category": "MATERIALS",
            "action": "ADD_BACK",
            "value": 0,
            "condition": {
                "materials_exceed_norms": true
            },
            "description": "Nguyên vật liệu sử dụng vượt định mức: phần vượt không được trừ",
            "reference": "TT78/2014/TT-BTC Điều 6",
            "effective_from": "2014-08-01"
        },
        {
            "code": "CIT_ENTERTAINMENT_LIMIT",
            "rule_type": "CIT_ADD_BACK",
            "category": "ENTERTAINMENT",
            "action": "LIMIT",
            "value": 500000,
            "description": "Chi tiếp khách tối đa 500k/người",
            "reference": "TT96/2015/TT-BTC",
            "effective_from": "2015-01-01"
        },
        {
            "code": "PIT_SELF_DEDUCTION",
            "rule_type": "PIT_DEDUCTION",
            "category": "FAMILY",
            "action": "DEDUCT",
            "value": 11000000,
            "description": "Giảm trừ gia cảnh bản thân: 11,000,000đ/tháng",
            "reference": "NQ954/2020/UBTVQH14",
            "effective_from": "2020-07-01"
        },
        {
            "code": "PIT_DEPENDENT_DEDUCTION",
            "rule_type": "PIT_DEDUCTION",
            "category": "FAMILY",
            "action": "DEDUCT",
            "value": 4400000,
            "description": "Giảm trừ người phụ thuộc: 4,400,000đ/người/tháng",
            "reference": "NQ954/2020/UBTVQH14",
            "effective_from": "2020-07-01"
        },
        {
            "code": "PIT_INSURANCE_RATE",
            "rule_type": "PIT_DEDUCTION",
            "category": "INSURANCE",
            "action": "DEDUCT",
            "value": 10.5,
            "description": "Tỷ lệ BHXH người lao động: 10.5%",
            "reference": "Luật BHXH",
            "effective_from": "2024-01-01"
        },
        {
            "code": "PIT_BRACKET_1",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_1",
            "action": "CALCULATE",
            "value": 5,
            "limit_value": 5000000,
            "condition": {
                "bracket": 1,
                "max_income": 5000000
            },
            "description": "Bậc 1: 0 - 5M → 5% (Công thức: TNTT × 0.05)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_BRACKET_2",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_2",
            "action": "CALCULATE",
            "value": 10,
            "limit_value": 10000000,
            "condition": {
                "bracket": 2,
                "min_income": 5000001,
                "max_income": 10000000,
                "quick_deduct": 250000
            },
            "description": "Bậc 2: 5M - 10M → 10% (Công thức: TNTT × 0.10 - 250,000)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_BRACKET_3",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_3",
            "action": "CALCULATE",
            "value": 15,
            "limit_value": 18000000,
            "condition": {
                "bracket": 3,
                "min_income": 10000001,
                "max_income": 18000000,
                "quick_deduct": 750000
            },
            "description": "Bậc 3: 10M - 18M → 15% (Công thức: TNTT × 0.15 - 750,000)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_BRACKET_4",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_4",
            "action": "CALCULATE",
            "value": 20,
            "limit_value": 32000000,
            "condition": {
                "bracket": 4,
                "min_income": 18000001,
                "max_income": 32000000,
                "quick_deduct": 1650000
            },
            "description": "Bậc 4: 18M - 32M → 20% (Công thức: TNTT × 0.20 - 1,650,000)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_BRACKET_5",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_5",
            "action": "CALCULATE",
            "value": 25,
            "limit_value": 52000000,
            "condition": {
                "bracket": 5,
                "min_income": 32000001,
                "max_income": 52000000,
                "quick_deduct": 3250000
            },
            "description": "Bậc 5: 32M - 52M → 25% (Công thức: TNTT × 0.25 - 3,250,000)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_BRACKET_6",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_6",
            "action": "CALCULATE",
            "value": 30,
            "limit_value": 80000000,
            "condition": {
                "bracket": 6,
                "min_income": 52000001,
                "max_income": 80000000,
                "quick_deduct": 5850000
            },
            "description": "Bậc 6: 52M - 80M → 30% (Công thức: TNTT × 0.30 - 5,850,000)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_BRACKET_7",
            "rule_type": "PIT_BRACKET",
            "category": "BRACKET_7",
            "action": "CALCULATE",
            "value": 35,
            "limit_value": null,
            "condition": {
                "bracket": 7,
                "min_income": 80000001,
                "quick_deduct": 9850000
            },
            "description": "Bậc 7: > 80M → 35% (Công thức: TNTT × 0.35 - 9,850,000)",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_FLAT_0",
            "rule_type": "PIT_DEDUCTION",
            "category": "CASUAL_LABOR",
            "action": "ALLOW",
            "value": 0,
            "condition": {
                "AND": [
                    {
                        "labor_type_in": [
                            "CASUAL",
                            "PROBATION"
                        ]
                    },
                    {
                        "amount_lt": 2000000
                    }
                ]
            },
            "description": "LĐ thời vụ/thử việc thu nhập < 2M: không khấu trừ",
            "reference": "TT111/2013/TT-BTC Điều 25",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_FLAT_10",
            "rule_type": "PIT_DEDUCTION",
            "category": "CASUAL_LABOR",
            "action": "DEDUCT",
            "value": 10,
            "condition": {
                "AND": [
                    {
                        "labor_type_in": [
                            "CASUAL",
                            "PROBATION"
                        ]
                    },
                    {
                        "amount_gte": 2000000
                    }
                ]
            },
            "description": "LĐ thời vụ/thử việc thu nhập >= 2M: khấu trừ 10%",
            "reference": "TT111/2013/TT-BTC Điều 25",
            "effective_from": "2014-01-01"
        },
        {
            "code": "PIT_FLAT_20",
            "rule_type": "PIT_DEDUCTION",
            "category": "NON_RESIDENT",
            "action": "DEDUCT",
            "value": 20,
            "condition": {
                "is_non_resident": true
            },
            "description": "Người không cư trú: khấu trừ 20%",
            "reference": "TT111/2013/TT-BTC",
            "effective_from": "2014-01-01"
        }
    ]
}